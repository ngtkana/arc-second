## ARC 087 C - Good Sequence

個数の足りているものをすべて採用です。


## ARC 087 D - FT Robot

各 $F$ でどの方向に進めるのかを調べましょう。
$T$ で区切られた各区間で方向は等しい必要があります。
また、$T$ が偶数回あったあとでは方向は $x$ で、奇数回ならば $y$ です。
さらにはじめに $T$ に出会うまでは右にしか進めません。
逆にこれさえ満たしていればなんでも達成できます。

$x, y$ 方向の移動道のりをそれぞれ計算です。届いていなかったり偶奇が違ったらだめです。
次に、ある区間を逆にするごとにその $2$ 倍の量逆戻りになりますから、戻れる区間をすべて見て部分和問題をするとよいです。


## ARC 087 E - Prefix-free Game

### 概念パート

選べる場所の残りは常に完全二分木の非交叉和です。
（頂点の数ベースでの）高さが $i$ のものの Grundy 数を $a _ i$ としましょう。
ここから遷移できるのはこちらです。
$$
    \begin{alignedat}{1}
        & 0, \\
        & a _ { i - 1 }, \\
        & a _ { i - 1 } \oplus a _ { i - 2 }, \\
        & a _ { i - 1 } \oplus a _ { i - 2 } \oplus a _ { i - 3 } \\
        & \vdots \\
        & a _ { i - 1 } \oplus a _ { i - 2 } \oplus a _ { i - 3 } \oplus \dots \oplus a _ { 1 }
    \end{alignedat}
$$

手計算をがんばると、$a _ i = \max \left\{ 2 ^ j \middle \vert i \in 2 ^ j \mathbb Z \right\}$
であることが予想できますから、Grundy 数の条件をチェックです。

| $i$     | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ | $9$ | $\cdots$ |
|-        |-    |-    |-    |-    |-    |-    |-    |-    |-    |-         |
| $a _ i$ | $1$ | $2$ | $1$ | $4$ | $1$ | $2$ | $1$ | $8$ | $1$ | $\cdots$ |


### 実装パート

トライを作って、文字列の終端があるところに印をつけておきましょう。
すると操作できる部分は、文字列の終端でない部分の、子がいないところですから、これを xor していき、AC です。


## ARC 087 F - Squirrel Migration

### 概念パート

移動距離の総和が最大になるのは、全員が木の重心を通ることと同値です。
特に、重心が辺なときには答えは $\left( \left( \frac n 2 \right)! \right) ^ 2$ です。
重心が頂点のときには、重心から生えている部分木すべての行き先が部分木の外であるような置換を数えると良いです。

### 数え上げパート

これ難しいです。
連想したのは完全順列です。完全順列の個数（Momtmort number, derangement number, subfactorial）の計算方法は $2$ 通り合って、一つは DP です。functnon graph において頂点 $0$ とその行き先を縮約する感じで考えると $a _ n = (n - 1) ( a _ { n - 2 } + a _ { n - 1 })$ になることがわかります。

もう一つは包除原理です。$i$ 箇所を固定してほかが自由なときには $(n - i)!$ ですからこのように計算ができます。これはもちろん漸化式も満たしているはずです。
$$
    a _ n = \sum _ { i = 0 } ^ n \binom n i ( -1 ) ^ i (n - i)!
        = n! \cdot \sum _ { i = 0 } ^ n \frac { ( -1 ) ^ i } { i ! }
$$

ちなみにこれは $n! / e$ にもっとも近い整数にも等しいようです。
また、$a _ n = n a _ { n - 1 } + ( -1 ) ^ n$ という漸化式も満たすようです。

どちらかをマイナーチェンジしてできそうなのですが、難しいです。


