## ARC 093 C - Traveling Plan

全部行く場合との差分は $| x _ { i + 1 } - x _ { i - 1 }| - | x _ i - x _ { i - 1 } | - | x _ { i + 1 } - x _ i |$ です。


## ARC 093 D - Grid Components

これの隙間を順番に埋めていくと良いです。

```
........
#.#.#.#.
#.#.#.#.
#.#.#.#.
#.#.#.#.
#.#.#.#.
#.#.#.#.
########
```

### 解説 PDF、解説放送を見て

これの隙間を順番に埋めていくと良いです。
あのですね。

```
........
........
........
........
########
########
########
########
```


## ARC 093 E - Bichrome Spanning Tree

$X$ が MST よりも小さいときには $0$ です。

そうでないときには、各辺について、それをふくむ全域木の中で最小なものの重さが

- red: $X$ 未満です。
- blue: $X$ ぴったりです。
- green: $X$ より大きいです。

と塗り分けます。

すると、red はすべて白色（←これは黒色でもよいのですが、片方に固定しています）、blue は少なくとも一つが黒色、green はなんでもよいです。


### 解説放送を観て

問題の答えが $f(X) - f(X-1)$ となるように $f$ をとるとよいようです。
すると条件が red が単色だけになり簡単です。


## ARC 093 F - Dark Horse

### 解説 PDF を読んで

解説 PDF の方針を踏襲しつつ、少し楽な方法です。
まずは計算量を度外視して DP を組み立てましょう。

$\mathtt{ dp } _ { i, U }$ は
$1$ さんがトーナメントの左端にいるとして、
はじめの $i$ 人（$2, 3, \dots 2 + i - 1$）をそれ以外の場所（$2, 3, \dots, 2 ^ n$）に割り当てる方法であって、
$U$ が解説 PDF で言う「開始済み」であるようなブロックの集合だとしましょう。

#### 遷移です。

まず、次に入れるのが解説放送で言う「天敵」である場合です。
この場合は開始済みのブロックに入れるしかありませんから、空席の個数分の係数を掛けて $U$ を変えずに遷移です。
$$
    \mathtt { dp } _ { i + 1, U } =  (\mathtt { mask }( U ) - i) \cdot \mathtt { dp } _ { i , U }
$$
ただし $\mathtt { mask } ( U )$ というのは、集合 $U$ を bitmask であわらした整数です。

一方、次に入れるのが天敵でない場合です。この場合は新しいブロックに入れても良いですから、真面目に書くと大変そうです。
そこで解説 PDF さんの匠ポイントなのですが、累積和（ゼータ変換）を取るとうまく行きます。どうして思いついたのですか？（泣）
説明するのがちょっと難しいですが、式はこのようになります。
$$
    \sum _ { V \subset U } \mathtt { dp } _ { i + 1, V } =
    (\mathtt { mask }( U ) - i) \sum _ { V \subset U } \cdot \mathtt { dp } _ { i , V }
$$
嬉しいことに、先ほどとまったく同じ遷移です。具体的には、累積和を取って遷移して隣接差で戻すとよいです。

これを素直に実装しても $\Theta ( 4 ^ N N )$ ですから、惜しいのですが若干間に合いません。


#### 高速化です。
　
ここまで来ると高速化は簡単で、$M \le 16$ を利用しましょう。
天敵でない場合の遷移を下方階乗冪で高速化して、AC です。

https://atcoder.jp/contests/arc093/submissions/15307653


### 解説放送を観て

包除原理です。
問題の条件はすべてのブロックマスター（←これはいまお名前をつけました）に勝てること、
言い換えると、どのブロックマスターも天敵でないことです。

天敵であるようなマスターのいるブロックの集合が、$U$ の superset であるような並べ方（$2 ^ n - 1$ の置換）を $a _ U$ とおくと、
答えは $\mathtt{ ans } = \sum _ { U \subset [n] } ( -1 ) ^ { n - \# U } a _ U$ となります。

これは人々を番号の大きい方から走査しながらマスター決定済みブロックの集合を管理する bit DP で達成可能です。
具体的には、$\mathtt{ dp } _ { i, U }$ は番号の大きい方から $i$ 人から何人か選んでを $2, 3, \dots, 2 ^ n$ に並べる方法であって、
集合 $U$ に対応するブロックのマスターが決定済みです。

天敵に出会うたびに、それを追加するパターンとしないパターンと、また追加するならばどこであるのかで場合分けです。
追加しない場合には当然係数は $1$ です。追加する場合には、余っている人数と選ぶべき人数の下方階乗冪です。
$$
\begin{array}{rll}
    \mathtt{ dp } _ { i + 1, U } \leftarrow ^ +&
        \mathtt { dp } _ { i, U }& \\
    \mathtt{ dp } _ { i + 1, U \cup \{ j \} } \leftarrow ^ +&
        \left( \mathtt{ mask } ( U ) - i )  \right) \mathtt { dp } _ { i, U }&
        { \rm for } \ i \not \in U \\
\end{array}
$$

TODO: こちらの方法でも通します。まだやる気はあるのですが、今日はもう遅いです。
